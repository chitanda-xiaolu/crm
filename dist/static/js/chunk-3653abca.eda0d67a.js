(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3653abca"],{"100d":function(e,t,a){},"12ba":function(e,t,a){"use strict";var r=a("6722"),i=a.n(r);i.a},"1ca4":function(e,t,a){"use strict";var r=a("100d"),i=a.n(r);i.a},"214b":function(e,t,a){},"247d":function(e,t,a){"use strict";var r=a("bcab"),i=a("fa7d"),s={store:{key:"store",btns:[{id:1,title:"编辑",icon:"el-icon-edit",type:"edit",isShow:function(){return Object(i["g"])(r["a"].store.update.code)}}]},business:{key:"bussiness-notice",btns:[{id:1,title:"编辑",icon:"el-icon-edit",type:"edit",isShow:function(){return Object(i["g"])(r["a"].businessNotice.update.code)}}]},system:{key:"system-notice",btns:[{id:1,title:"编辑",icon:"el-icon-edit",type:"edit",isShow:function(){return Object(i["g"])(r["a"].systemNotice.update.code)}}]},activity:{key:"activity",btns:[{id:1,title:"编辑",icon:"el-icon-edit",type:"edit",isShow:function(){return Object(i["g"])(r["a"].marketActivity.update.code)}}]},staff:{key:"staff",btns:[{id:1,title:"编辑",icon:"el-icon-edit",type:"edit",isShow:function(){return Object(i["g"])(r["a"].user.update.code)}},{id:2,title:"重置密码",icon:"el-icon-refresh-left",type:"reset",isShow:function(){return Object(i["g"])(r["a"].user.reset.code)}},{id:3,title:"绑定酷家乐",icon:"el-icon-connection",type:"bind",isShow:function(){return Object(i["g"])(r["a"].user.bindKjl.code)}}]},help:{key:"help",btns:[{id:1,title:"编辑",icon:"el-icon-edit",type:"edit",isShow:function(){return Object(i["g"])(r["a"].help.update.code)}}]},menu:{key:"menu",btns:[{id:1,title:"编辑",icon:"el-icon-edit",type:"edit",isShow:function(){return Object(i["g"])(r["a"].menu.update.code)}}]},account:{key:"account",btns:[{id:1,title:"现金充值",icon:"el-icon-medal-1",type:"cash",isShow:function(){return Object(i["g"])(r["a"].account.recharge_add.code)}},{id:2,title:"返利充值",type:"fanli",icon:"el-icon-medal",isShow:function(){return Object(i["g"])(r["a"].account.recharge_add.code)}}]},distributorDetail:{key:"dept-distributor",btns:[{id:1,title:"重置密码",icon:"el-icon-refresh-left",type:"reset",isShow:function(){return Object(i["g"])(r["a"].user.reset.code)}},{id:2,title:"绑定酷家乐",icon:"el-icon-connection",type:"bind",isShow:function(){return Object(i["g"])(r["a"].user.bindKjl.code)}}]},deptAccount:{key:"dept-account",btns:[{id:1,title:"重置密码",icon:"el-icon-refresh-left",type:"reset",isShow:function(){return Object(i["g"])(r["a"].user.reset.code)}}]},order:{key:"order",btns:[{id:1,title:"编辑",icon:"el-icon-edit",type:"editCad",isShow:function(e){return 1001===e.status&&20===e.orderWay}},{id:2,title:"初审认领",icon:"el-icon-circle-check",type:"claim",isShow:function(e){return Object(i["g"])(r["a"].order.hq_claim.code)&&2001===e.status}},{id:3,title:"终审认领",icon:"el-icon-circle-check",type:"finishClaim",isShow:function(e){return Object(i["g"])(r["a"].order.hq_claim_final.code)&&3001===e.status}},{id:4,title:"改价确认",icon:"el-icon-success",type:"changePrice",isShow:function(e){return Object(i["g"])(r["a"].price.modify_confirm.code)&&4001===e.status}},{id:5,title:"翻图驳回",icon:"el-icon-refresh-left",type:"rebackCad",isShow:function(e){return Object(i["g"])(r["a"].order.cad_reject.code)&&1101===e.status}}]},product:{key:"product",btns:[{id:1,title:"编辑",type:"edit",icon:"el-icon-edit",isShow:function(e){return Object(i["g"])(r["a"].product.edit.code)}}]}};t["a"]=s},"2c21":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"dataForm",staticClass:"padding-top-14",attrs:{"label-position":e.labelPosition,"label-width":e.labelWidth||"100px",model:e.dataForm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchList()}}},[a("div",{staticClass:"search-box"},e._l(e.showList,(function(t,r){return a("el-form-item",{key:r,class:{"order-length-date":t.date,"order-length-deduction":t.deduction,"order-length-type":t.orderType,"order-length-stage":t.stage,"order-length-claim":t.claim,"order-length-finish-claim":t.finishClaim,"order-length-mmodify-price":t.modifyPrice},attrs:{label:t.label+":","label-width":t.width,prop:""+t.code}},["input"===t.type?a("el-input",{attrs:{clearable:!0,placeholder:"请输入"+t.label+(t.extralabel||"")},model:{value:e.dataForm[t.code],callback:function(a){e.$set(e.dataForm,t.code,a)},expression:"dataForm[item.code]"}}):e._e(),"date"===t.type?a("el-date-picker",{attrs:{type:t.flag?"date":"daterange","value-format":"yyyy-MM-dd",placeholder:t.flag?"请选择日期":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.dataForm[t.code],callback:function(a){e.$set(e.dataForm,t.code,a)},expression:"dataForm[item.code]"}}):e._e(),"radio"===t.type?e._l(t.radioType,(function(r,i){return a("el-radio",{key:i,attrs:{label:r.value},model:{value:e.dataForm[t.code],callback:function(a){e.$set(e.dataForm,t.code,a)},expression:"dataForm[item.code]"}},[e._v(e._s(r.name))])})):e._e(),"select"===t.type?[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:e.dataForm[t.code],callback:function(a){e.$set(e.dataForm,t.code,a)},expression:"dataForm[item.code]"}},e._l(t.selectList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.areaName,value:e.id}})})),1)]:e._e(),"cascader"===t.type?[a("el-cascader",{staticStyle:{width:"100%"},attrs:{"change-on-select":"",clearable:"",placeholder:"请选择产品",options:t.cascaderList,filterable:""},model:{value:e.dataForm[t.code],callback:function(a){e.$set(e.dataForm,t.code,a)},expression:"dataForm[item.code]"}})]:e._e(),"areaselect"===t.type?[a("area-select",{attrs:{isselectAll:!0,isOrder:!0}})]:e._e(),e.hiddenInput?a("input",{staticStyle:{display:"none"},attrs:{id:"hiddenText",type:"text"}}):e._e(),"area"===t.type?a("area-select"):e._e()],2)})),1),a("el-form-item",{staticClass:"search-btns"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.searchList()}}},[e._v("查询")]),a("el-button",{on:{click:function(t){return e.resetForm()}}},[e._v("重置")]),a("span",{directives:[{name:"show",rawName:"v-show",value:e.formList.length>7,expression:"formList.length >7"}],staticClass:"show-more",on:{click:function(t){e.showAll=!e.showAll}}},[a("i",{directives:[{name:"show",rawName:"v-show",value:1==e.openOrclose,expression:"openOrclose == 1"}],staticClass:"iconfont icon-zhankai"},[a("span",{staticClass:"iconfont-label"},[e._v("展开")])]),a("i",{directives:[{name:"show",rawName:"v-show",value:1!==e.openOrclose,expression:"openOrclose !== 1"}],staticClass:"iconfont icon-open"},[a("span",{staticClass:"iconfont-label"},[e._v("收起")])])])],1)],1)},i=[],s=(a("8e6e"),a("cadf"),a("456d"),a("ac6a"),a("bd86")),o=(a("7f7f"),a("2f62")),n=a("1f87");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d={components:{AreaSelect:n["a"]},props:["labelWidth"],data:function(){return{key:this.$route.name,labelPosition:"right",dataForm:{},hiddenInput:!1,showAll:!1,formList:[]}},computed:c({},Object(o["d"])({queryData:"queryCondition"}),{openOrclose:function(){return this.showAll?2:1},showList:function(){if(this.showAll)return this.formList;var e=[];if(this.formList.length>7)for(var t=0;t<6;t++)e.push(this.formList[t]);else e=this.formList;return e}}),mounted:function(){var e={},t=0;this.formList=this.queryData.query[this.key].dataForm,this.formList.forEach((function(a){e[a.code]=a.value||a.default||"","input"===a.type&&t++})),1===t&&(this.hiddenInput=!0),this.dataForm=e},methods:c({},Object(o["c"])({setQuerys:"SET_QUERYS",setCurrent:"SET_PAGINATION_CURRENT",setCodeList:"SET_CODE_LIST"}),{searchList:function(){var e={key:this.key,current:1};this.setCurrent(e),this.setQuerys({key:this.key,query:this.dataForm}),this.$parent.getDataList()},resetForm:function(){var e=this;e.formList.forEach((function(t){t.value=t.default||"",e.dataForm[t.code]=t.default||""})),e.setCodeList(),e.setQuerys({key:e.key,query:e.dataForm})}})},u=d,p=(a("12ba"),a("2877")),m=Object(p["a"])(u,r,i,!1,null,"2de32179",null);t["a"]=m.exports},"3c0f":function(e,t,a){},"472f":function(e,t,a){"use strict";var r=a("b212"),i=a.n(r);i.a},"47fd":function(e,t,a){"use strict";var r={scrollPanel:{scrollingX:!1},bar:{hoverStyle:!0,onlyShowBarOnScroll:!1,background:"#ccc",scrollingX:!1,initialScrollX:!1,size:"5px"},rail:{}};t["a"]=r},"61f7":function(e,t,a){"use strict";a.d(t,"f",(function(){return r})),a.d(t,"d",(function(){return i})),a.d(t,"e",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return l}));a("a481");function r(e,t,a){/^[0-9]{11}$/.test(t)?a():a(new Error("请输入正确的手机号"))}function i(e,t,a){/^([1-9]\d*|0)(\.\d*[0-9])?$/.test(t)?a():a(new Error("请输入正数"))}function s(e,t,a){parseFloat(t)>0?a():a(new Error("请输入正数"))}function o(e){var t={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"',"#40":"(","#41":")"};return e&&e.replace(/&(lt|gt|nbsp|amp|quot|#40|#41);/gi,(function(e,a){return t[a]}))}function n(e){var t=new Date(e),a=t.getFullYear()+"-",r=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",i=t.getDate()<10?"0"+t.getDate():t.getDate(),s=a+r+i;return s}function l(e){var t=e.substring(0,19);t=t.replace(/-/g,"/");var a=new Date(t).getTime();return a}},6722:function(e,t,a){},"77bb":function(e,t,a){"use strict";var r=a("c84f"),i=a.n(r);i.a},b212:function(e,t,a){},b3bc:function(e,t,a){"use strict";var r=a("3c0f"),i=a.n(r);i.a},b97d:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-box dis-flex-row"},[a("div",{staticClass:"main-box-left dept-tree"},[a("Tree",{attrs:{status:e.dataForm.status},on:{isShow:e.isShowStatus}})],1),a("div",{staticClass:"main-box-right user-list"},[a("form-module"),a("div",{staticClass:"opt-btn"},[e.hasPermission(e.Permission.user.create.code)?a("el-button",{staticStyle:{"margin-bottom":"8px"},attrs:{size:"mini",icon:"el-icon-plus",type:"primary",plain:""},on:{click:e.addHandle}},[e._v("新增")]):e._e()],1),a("best-tables",{attrs:{"data-list":e.deptUsrt.userList,total:e.deptUsrt.total,specialClass:e.specialClass,optBtnList:this.optBtnList()},on:{optThisRow:e.optThisRow}}),a("add-user",{ref:"addDialog"}),a("edit-user",{ref:"editDialog"})],1),a("el-dialog",{attrs:{title:"绑定酷家乐(KJL）账号",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t},open:e.openbindDialog}},[a("el-form",{ref:"bindkjlDialog",staticClass:"demo-dynamic",attrs:{model:e.bindkjlDialog,"label-width":"100px"}},[a("el-form-item",{attrs:{prop:"email",label:"账号",rules:[{required:!0,message:"请输入账号",trigger:"blur"},{type:"email",message:"请输入正确账号格式",trigger:["blur","change"]}]}},[a("el-input",{staticStyle:{width:"79%"},attrs:{clearable:""},model:{value:e.bindkjlDialog.email,callback:function(t){e.$set(e.bindkjlDialog,"email",t)},expression:"bindkjlDialog.email"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.bindKjlNo("bindkjlDialog")}}},[e._v("确 定")])],1)],1)],1)},i=[],s=(a("8e6e"),a("ac6a"),a("cadf"),a("456d"),a("bd86")),o=(a("7f7f"),a("184e")),n=a("2c21"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"新增员工","close-on-click-modal":!1,visible:e.visible,"destroy-on-close":!0,width:"30%"},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"dataForm",attrs:{model:e.dataForm,rules:e.dataRule,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"姓名：",prop:"name"}},[a("el-input",{staticStyle:{width:"87%"},attrs:{clearable:"",type:"text",placeholder:"员工姓名"},model:{value:e.dataForm.name,callback:function(t){e.$set(e.dataForm,"name",t)},expression:"dataForm.name"}})],1),a("el-form-item",{attrs:{label:"手机：",prop:"phone"}},[a("el-input",{staticStyle:{width:"87%"},attrs:{clearable:"",type:"text",placeholder:"员工手机号码"},model:{value:e.dataForm.phone,callback:function(t){e.$set(e.dataForm,"phone",t)},expression:"dataForm.phone"}})],1),a("el-form-item",{attrs:{label:"部门：",prop:"deptId"}},[a("el-cascader",{staticStyle:{width:"87%"},attrs:{placeholder:"请选择部门",debounce:1e3,options:e.deptUsrtData.deptTreeDisplay,"change-on-select":"",filterable:""},on:{change:e.hendleChangeCascader},model:{value:e.dataForm.deptId,callback:function(t){e.$set(e.dataForm,"deptId",t)},expression:"dataForm.deptId"}})],1),a("el-form-item",{attrs:{label:"岗位：",prop:"roleId"}},[a("el-select",{staticStyle:{width:"87%"},attrs:{filterable:"",remote:"",clearable:"","reserve-keyword":"",placeholder:"请选择岗位"},on:{change:e.changeRole},model:{value:e.dataForm.roleId,callback:function(t){e.$set(e.dataForm,"roleId",t)},expression:"dataForm.roleId"}},e._l(e.deptUsrtData.roleTree,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.roleId,disabled:1==e.status}})})),1)],1),a("el-form-item",{attrs:{label:"员工状态：",size:"mini",prop:"status"}},[a("el-radio-group",{on:{change:e.changeUserStatus},model:{value:e.dataForm.status,callback:function(t){e.$set(e.dataForm,"status",t)},expression:"dataForm.status"}},[a("el-radio",{attrs:{label:"0"}},[e._v("在职")]),a("el-radio",{attrs:{label:"1"}},[e._v("离职")])],1)],1),a("el-form-item",{attrs:{label:"允许登录：",prop:"allowLogin"}},[a("el-switch",{on:{change:e.handleallowLogin},model:{value:e.dataForm.allowLogin,callback:function(t){e.$set(e.dataForm,"allowLogin",t)},expression:"dataForm.allowLogin"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmit()}}},[e._v("确定")])],1)],1)},c=[],d=a("dcd1"),u=a("fa7d"),p=a("2f62"),m=a("61f7");function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(Object(a),!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var b={props:["status"],data:function(){return{userId:"",visible:!1,roleList:[],dataForm:{name:"",phone:"",roleName:null,roleId:null,deptId:"",deptName:[],allowLogin:!0,status:"0"},dataRule:{name:[{required:!0,message:"员工姓名不能为空",trigger:"change"}],deptId:[{required:!0,message:"部门不能为空",trigger:"blur"}],phone:[{required:!0,message:"手机号码不能为空",trigger:"change"},{validator:m["f"],trigger:"change"}]}}},computed:h({},Object(p["d"])({deptUsrtData:"deptUser",queryData:"queryCondition"})),mounted:function(){},methods:h({},Object(p["c"])({setDom:"SET_DOM",setPagination:"SET_PAGINATION"}),{},Object(p["b"])({getData:"getData",getDeptDisplay:"getDeptDisplay"}),{changeRole:function(e){this.dataForm.roleId=e},changeUserStatus:function(e){"1"===e&&(this.dataForm.allowLogin=!1)},handleallowLogin:function(e){this.dataForm.allowLogin=e},hendleChangeCascader:function(){this.$refs["dataForm"]&&this.$refs["dataForm"].validateField("deptId")},dataFormSubmit:function(){var e=this;this.$refs["dataForm"].validate((function(t){var a=e;if(t){var r=Object(u["e"])(a.dataForm);r.allowLogin=a.dataForm.allowLogin,"string"===typeof a.dataForm.deptId?r.deptId=a.dataForm.deptId:r.deptId=a.dataForm.deptId.pop(),Object(d["c"])(r).then((function(e){if(200===e.code&&e.success){a.$message.success("新增成功");var t={size:a.queryData.query[a.$route.name].pagination.size,current:1};a.setPagination(t),a.$refs["dataForm"].resetFields(),a.userAfterInit()}else a.$message.error("".concat(e.message," || 新增失败"))})),setTimeout((function(){var e=document.getElementsByClassName("is-checked")[0];a.setDom(e),e.children[0].style.background="#f0f7ff"}),200)}}))},userAfterInit:function(){this.visible=!1,this.getDeptDisplay({platform:1,status:this.status,userStatus:this.queryData.query[this.$route.name].dataForm.status}),this.getData(Object(u["k"])(this.queryData.query[this.$route.name].pagination,{deptId:this.deptUsrtData.selectDeptId,status:this.queryData.query[this.$route.name].dataForm.status}))}})},g=b,y=(a("77bb"),a("2877")),O=Object(y["a"])(g,l,c,!1,null,"789784ce",null),v=O.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"编辑员工","close-on-click-modal":!1,visible:e.visible,"destroy-on-close":!0,width:"30%"},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"dataForm",attrs:{model:e.dataForm,rules:e.dataRule,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"姓名：",prop:"name"}},[a("el-input",{staticStyle:{width:"87%"},attrs:{type:"text",clearable:"",placeholder:"员工姓名"},model:{value:e.dataForm.name,callback:function(t){e.$set(e.dataForm,"name",t)},expression:"dataForm.name"}})],1),a("el-form-item",{attrs:{label:"手机：",prop:"phone"}},[a("el-input",{staticStyle:{width:"87%"},attrs:{type:"text",clearable:"",placeholder:"员工手机号码"},model:{value:e.dataForm.phone,callback:function(t){e.$set(e.dataForm,"phone",t)},expression:"dataForm.phone"}})],1),a("el-form-item",{attrs:{label:"部门：",prop:"deptId"}},[a("el-cascader",{staticStyle:{width:"87%"},attrs:{placeholder:"请选择部门",debounce:1e3,options:e.deptUsrtData.deptTreeDisplay,"change-on-select":"",filterable:""},on:{change:e.hendleChangeCascader},model:{value:e.dataForm.deptId,callback:function(t){e.$set(e.dataForm,"deptId",t)},expression:"dataForm.deptId"}})],1),a("el-form-item",{attrs:{label:"岗位：",prop:"roleId"}},[a("el-select",{staticStyle:{width:"87%"},attrs:{filterable:"",remote:"",clearable:"","reserve-keyword":"",placeholder:"请选择岗位"},on:{change:e.changeRole},model:{value:e.dataForm.roleId,callback:function(t){e.$set(e.dataForm,"roleId",t)},expression:"dataForm.roleId"}},e._l(e.deptUsrtData.roleTree,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.roleId,disabled:1==e.status}})})),1)],1),a("el-form-item",{attrs:{label:"员工状态：",size:"mini",prop:"status"}},[a("el-radio-group",{on:{change:e.changeUserStatus},model:{value:e.dataForm.status,callback:function(t){e.$set(e.dataForm,"status",t)},expression:"dataForm.status"}},[a("el-radio",{attrs:{label:"0"}},[e._v("在职")]),a("el-radio",{attrs:{label:"1"}},[e._v("离职")])],1)],1),a("el-form-item",{attrs:{label:"允许登录：",prop:"allowLogin"}},[a("el-switch",{on:{change:e.handleAllowLogin},model:{value:e.dataForm.allowLogin,callback:function(t){e.$set(e.dataForm,"allowLogin",t)},expression:"dataForm.allowLogin"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmit()}}},[e._v("确定")])],1)],1)},D=[],j=(a("6b54"),a("01ea"));function F(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?F(Object(a),!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var S={props:["status"],data:function(){return{userId:"",visible:!1,roleList:[],dataForm:{id:0,name:"",phone:"",roleName:null,roleId:null,deptId:"",deptName:[],allowLogin:!0,status:"0"},dataRule:{name:[{required:!0,message:"员工姓名不能为空",trigger:"change"}],deptId:[{required:!0,message:"部门不能为空",trigger:"blur"}],phone:[{required:!0,message:"手机号码不能为空",trigger:"change"},{validator:m["f"],trigger:"change"}]}}},computed:k({},Object(p["d"])({deptUsrtData:"deptUser",queryData:"queryCondition"})),mounted:function(){},methods:k({},Object(p["c"])({setDom:"SET_DOM",setPagination:"SET_PAGINATION"}),{},Object(p["b"])({getData:"getData",getRole:"getRole",getDeptDisplay:"getDeptDisplay"}),{init:function(e){var t=this;t.userId=e,t.visible=!0,t.dataForm.id=e||0,t.getDeptDisplay({status:"0",platform:j["a"].COMPANY_PLATFORM}),t.getRole({platform:j["a"].COMPANY_PLATFORM}),e?Object(d["o"])({userId:e}).then((function(e){if(200===e.code&&e.success){var a=e.data,r=Object(u["m"])(a,["name","phone","roleName","roleId","allowLogin","status","deptId"]);r.deptId="number"===typeof r.deptId?r.deptId.toString():r.deptId,r.status=r.status.toString(),t.dataForm=k({},r)}else t.dataForm={}})).catch((function(){console.log("error")})):this.$refs.dataForm.resetField()},changeRole:function(e){this.dataForm.roleId=e},changeUserStatus:function(e){"1"===e&&(this.dataForm.allowLogin=!1)},handleAllowLogin:function(e){this.dataForm.allowLogin=e},hendleChangeCascader:function(){this.$refs["dataForm"]&&this.$refs["dataForm"].validateField("deptId")},dataFormSubmit:function(){var e=this;this.$refs["dataForm"].validate((function(t){var a=e;if(t){var r=Object(u["e"])(a.dataForm);r.allowLogin=a.dataForm.allowLogin,"string"===typeof a.dataForm.deptId?r.deptId=a.dataForm.deptId:r.deptId=a.dataForm.deptId.pop(),r.userId=a.userId,Object(d["f"])(r).then((function(e){200===e.code&&e.success?(a.$message.success("编辑成功"),a.userAfterInit()):a.$message.error("编辑失败")})),setTimeout((function(){var e=document.getElementsByClassName("is-checked")[0];a.setDom(e),e.children[0].style.background="#f0f7ff"}),200)}}))},userAfterInit:function(){this.visible=!1,this.getDeptDisplay({platform:1,status:this.status,userStatus:this.queryData.query[this.$route.name].dataForm[3].value}),this.getData(Object(u["k"])(this.queryData.query[this.$route.name].pagination,{deptId:this.deptUsrtData.selectDeptId,status:this.queryData.query[this.$route.name].dataForm[3].value}))}})},I=S,P=(a("472f"),Object(y["a"])(I,w,D,!1,null,"456ea4cc",null)),_=P.exports,C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tree-container"},[a("div",{staticClass:"tree-top"},[a("div",{staticClass:"tree-title"},[e._v("布兰莎（"+e._s(e.deptUsrt.userName?e.deptUsrt.userName+":":"")+" "+e._s(e.deptUsrt.number)+"人）")]),a("span",{staticClass:"bl-xs-btn el-button--primary is-plain",on:{click:e.createDept}},[a("i",{staticClass:"el-icon-plus"}),e._v("新增")]),a("span",{staticClass:"bl-xs-btn el-button--warning is-plain margin-left-20",on:{click:e.editDept}},[a("i",{staticClass:"el-icon-edit"}),e._v("编辑")])]),a("vue-scroll",{staticClass:"filter-tree",attrs:{ops:e.scrollops}},[a("el-tree",{ref:"tree",attrs:{data:e.deptUsrt.deptTree,"node-key":"nodeId","default-expanded-keys":e.expandedKeys,"default-checked-keys":e.checkedKeys,"highlight-current":!0,"render-content":e.renderContent},on:{"node-click":e.changeNode,"node-expand":function(t){return e.getCurrentKey(t,0)},"node-collapse":function(t){return e.getCurrentKey(t,1)}}})],1),a("el-switch",{staticClass:"show-all",attrs:{"active-text":"有效","inactive-text":"全部"},on:{change:e.showAll},model:{value:e.isShow,callback:function(t){e.isShow=t},expression:"isShow"}}),e.addOrUpdateVisible?a("add-or-update",{ref:"addOrUpdate",attrs:{dept:e.deptInfo,isShowStatus:e.isShow?"0":"",editdept:e.addOredit}}):e._e()],1)},$=[],L=a("47fd"),x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"add"==e.editdept?"新增部门":"编辑部门","close-on-click-modal":!1,visible:e.visible,"destroy-on-close":!0,width:"30%"},on:{"update:visible":function(t){e.visible=t},open:function(t){return e.showModal(e.editdept)}}},[a("el-form",{ref:"dataForm",attrs:{model:e.dataForm,rules:e.dataRule,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"上级部门：",prop:"pid"}},[a("el-cascader",{staticStyle:{width:"87%"},attrs:{placeholder:"请选择上级部门",options:"add"===e.editdept?e.deptUsrt.deptTree:e.deptUsrt.editTree,filterable:"","change-on-select":""},on:{change:e.hendleChangeCascader},model:{value:e.dataForm.pid,callback:function(t){e.$set(e.dataForm,"pid",t)},expression:"dataForm.pid"}})],1),a("el-form-item",{attrs:{label:"部门名称：",prop:"simpleName"}},[a("el-input",{staticStyle:{width:"87%"},attrs:{clearable:"",placeholder:"部门名称"},model:{value:e.dataForm.simpleName,callback:function(t){e.$set(e.dataForm,"simpleName",t)},expression:"dataForm.simpleName"}})],1),a("el-form-item",{attrs:{label:"部门主管：",prop:"userId"}},[a("el-select",{staticStyle:{width:"87%"},attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"请选择主管"},on:{change:e.changeManager},model:{value:e.dataForm.userId,callback:function(t){e.$set(e.dataForm,"userId",t)},expression:"dataForm.userId"}},e._l(e.deptUsrt.managerList,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.name,disabled:1==e.status,value:e.userId}})})),1)],1),a("el-form-item",{attrs:{label:"部门状态：",size:"mini",prop:"status"}},[a("el-radio-group",{model:{value:e.dataForm.status,callback:function(t){e.$set(e.dataForm,"status",t)},expression:"dataForm.status"}},[a("el-radio",{attrs:{label:"0"}},[e._v("有效")]),a("el-radio",{attrs:{label:"1"}},[e._v("无效")])],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmit()}}},[e._v("确定")])],1)],1)},N=[];function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function U(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var A={props:["dept","editdept","isShowStatus"],data:function(){return{managerList:[],visible:!1,dataForm:{pid:[],simpleName:"",userId:"",status:"0",pName:[],userName:""},dataRule:{pid:[{required:!0,message:"上级部门不能为空",trigger:"change"}],simpleName:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],status:[{required:!0,message:"部门状态不能为空",trigger:"change"}]}}},computed:U({},Object(p["d"])({deptUsrt:"deptUser"})),methods:U({},Object(p["b"])({getDept:"getDept",getManager:"getManager",getDeptFilterTree:"getDeptFilterTree"}),{changeManager:function(e){this.dataForm.userId=e},showModal:function(e){e&&(this.dataForm={pid:[],simpleName:"",userId:"",status:"0",pName:[],userName:""})},init:function(e){var t=this;this.getManager({platform:j["a"].COMPANY_PLATFORM}),this.visible=!0,"add"===this.editdept?e.showModal(!0):this.dept&&(this.getDeptFilterTree({deptId:this.dept}),Object(d["d"])({deptId:this.dept}).then((function(a){if(200===a.code&&a.success){var r=a.data,i=Object(u["m"])(r,["pid","simpleName","status","pName","userId","userName"]);i.pid="number"===typeof i.pid?i.pid.toString():i.pid,i.status=i.status.toString(),t.dataForm=U({},i)}else e.$refs["dataForm"].resetFields()})))},includeInvalid:function(e){var t=!0;return this.deptUsrt.managerList.map((function(a){a.name===e&&(t=!1),e||(t=!1)})),t},dataFormSubmit:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t){var a=e,r=Object(u["e"])(a.dataForm);r.pid=r.pid instanceof Array?r.pid=r.pid[r.pid.length-1]:r.pid,"add"===a.editdept?Object(d["b"])(r).then((function(e){200===e.code&&e.success?(a.$message.success("新增成功"),a.getDept({status:a.isShowStatus,userStatus:"0",platform:j["a"].COMPANY_PLATFORM}),a.visible=!1):a.$message.error("新增失败")})):(r.deptId=a.dept,Object(d["e"])(r).then((function(){a.$message.success("编辑成功"),a.getDept({status:a.isShowStatus,userStatus:"0",platform:j["a"].COMPANY_PLATFORM}),a.visible=!1})))}}))},hendleChangeCascader:function(){this.$refs["dataForm"]&&this.$refs["dataForm"].validateField("pid")}})},q=A,E=(a("cc9b"),Object(y["a"])(q,x,N,!1,null,"5d35f37b",null)),M=E.exports;function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function K(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var V={props:["status"],components:{AddOrUpdate:M},data:function(){return{scrollops:L["a"],key:"user",isShow:!0,addOrUpdateVisible:!1,addOredit:"",deptInfo:"24",filterText:"",defaultProps:{children:"children",label:"label"},isSelected:!0,expandedKeys:["24"],checkedKeys:[""]}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},mounted:function(){this.getDept({status:0,userStatus:0,platform:j["a"].COMPANY_PLATFORM})},computed:K({},Object(p["d"])({queryData:"queryCondition",deptUsrt:"deptUser"})),methods:K({},Object(p["c"])({setDeptId:"SET_DEPTID",setCurrent:"SET_PAGINATION_CURRENT"}),{},Object(p["b"])({getData:"getData",getDept:"getDept"}),{showAll:function(e){var t={platform:j["a"].COMPANY_PLATFORM,status:e?0:"",userStatus:this.status};this.getDept(t),this.$emit("isShow",this.isShow?"0":"")},renderContent:function(e,t){var a=t.node,r=t.data;return e("span",[e("span",[e("span",[a.label])]),e("span",[e("p",{attrs:{size:"mini"},style:"color:#E6A23C;"},["".concat(r.userName?r.userName+"：":r.userName).concat(r.countUser||0)])])])},changeNode:function(e){this.deptUsrt.isCheckedDom&&(this.deptUsrt.isCheckedDom.children[0].style.background="");var t={key:this.key,current:1};this.setCurrent(t),this.setDeptId(e.value);var a=Object(u["k"])(Object(u["l"])(this.queryData.query[this.key].dataForm),this.queryData.query[this.key].pagination,{deptId:this.deptUsrt.selectDeptId});this.getData(Object(u["e"])(a)),this.checkedKeys[0]=e.value},createDept:function(e){var t=this;this.addOrUpdateVisible=!0,this.addOredit="add",this.deptInfo=this.deptUsrt.selectDeptId||"24",this.$nextTick((function(){t.$refs.addOrUpdate.init(t.$refs.addOrUpdate,e)}))},editDept:function(){var e=this;this.deptInfo=this.deptUsrt.selectDeptId,this.addOredit="editDept",this.deptUsrt.selectDeptId?this.addOrUpdateVisible=!0:(this.addOrUpdateVisible=!1,this.$message({message:"请先选择要编辑的部门",type:"warning"})),this.$nextTick((function(){e.$refs.addOrUpdate&&e.$refs.addOrUpdate.init(e.$refs.addOrUpdate,e.deptUsrt.selectDeptId)}))},getCurrentKey:function(e,t){this.checkedKeys[0]=e.nodeId,t?Object(u["b"])(this.expandedKeys,e.nodeId):this.expandedKeys.push(e.nodeId)}})},Y=V,B=(a("1ca4"),Object(y["a"])(Y,C,$,!1,null,null,null)),z=B.exports,H=a("7306"),G=a("247d");function Q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function J(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(a),!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var W={name:"user",components:{addUser:v,editUser:_,BestTables:o["a"],FormModule:n["a"],Tree:z},data:function(){var e=this;return{key:e.$route.name,labelPosition:"right",dataForm:{name:"",phone:"",roleName:"",status:"0"},specialClass:{className:"invalid-row",id:"statusName",value:"离职"},dataListLoading:!1,addOrUpdateVisible:!1,addVisible:!1,platform:j["a"].COMPANY_PLATFORM,isShow:"0",dialogVisible:!1,bindkjlDialog:{email:""}}},computed:J({},Object(p["d"])({deptUsrt:"deptUser",queryData:"queryCondition"})),mounted:function(){this.getDataList()},methods:J({},Object(p["c"])({setDeptId:"SET_DEPTID",setDom:"SET_DOM"}),{},Object(p["b"])({getData:"getData",getDept:"getDept",getDeptDisplay:"getDeptDisplay",getRole:"getRole"}),{tableRowClassName:function(e){var t=e.row;return 1===t.status?"invalid-row":""},optBtnList:function(){return G["a"].staff.btns},isShowStatus:function(e){this.isShow=e},optThisRow:function(e,t){switch(t){case"edit":this.editHandle(e);break;case"reset":this.resetPassword(e);break;case"bind":this.bindkjl(e);break}},resetPassword:function(e){var t=this;Object(d["n"])({userId:e.userId}).then((function(e){200===e.code&&e.success?t.$message.success({message:"重置成功,当前密码是:".concat(e.data.password),duration:4e3}):t.$message({message:e.message||"请求错误",type:"error",duration:3e3})}))},getDataList:function(){var e=this,t=Object(u["k"])(Object(u["l"])(e.queryData.query[e.key].dataForm),e.queryData.query[e.key].pagination,{deptId:this.deptUsrt.selectDeptId});e.refreshData(Object(u["e"])(t)),setTimeout((function(){var t=document.getElementsByClassName("is-checked")[0];e.setDom(t),t.children[0].style.background="#f0f7ff"}),200)},bindEmployeeHandle:function(){var e=this,t=e.bindkjlDialog.email,a=e.rowId;Object(d["a"])({kjlAccount:t,id:a}).then((function(t){200===t.code&&t.success&&(e.$message.success("操作成功"),e.dialogVisible=!1,e.getDataList())}))},bindkjl:function(e){this.kjlAccount=e.kjlAccount,this.dialogVisible=!0,this.rowId=e.userId},bindKjlNo:function(e){var t=this,a=this,r=a.bindkjlDialog.email;a.$refs[e].validate((function(e){e&&Object(H["c"])({kjlAccount:r}).then((function(e){if(200===e.code&&e.success)if(e.data.isBind){var r=e.data.bindList,i=[];r&&r.map((function(e){i.push(e)})),t.$confirm("该账号已绑定过: ".concat(i.join(),", 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.bindEmployeeHandle()})).catch((function(){}))}else a.bindEmployeeHandle()}))}))},openbindDialog:function(){this.$refs["loginForm"]&&this.$refs["loginForm"].clearValidate(),this.bindkjlDialog.email=this.kjlAccount||""},refreshData:function(e){this.getData(e),this.getDept({status:this.isShow,userStatus:this.queryData.query[this.key].dataForm.status,platform:this.platform})},tableSizeChange:function(){this.getDataList()},tableCurrentChange:function(){this.getDataList()},addHandle:function(){this.$refs.addDialog.visible=!0,this.getDeptDisplay({status:"0",platform:j["a"].COMPANY_PLATFORM}),this.getRole({platform:j["a"].COMPANY_PLATFORM})},editHandle:function(e){var t=this;this.$refs.editDialog.visible=!0,this.$nextTick((function(){t.$refs.editDialog.init(e.userId)}))}})},X=W,Z=(a("b3bc"),Object(y["a"])(X,r,i,!1,null,"debc739e",null));t["default"]=Z.exports},c84f:function(e,t,a){},cc9b:function(e,t,a){"use strict";var r=a("214b"),i=a.n(r);i.a}}]);