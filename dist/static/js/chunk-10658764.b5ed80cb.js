(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-10658764"],{"47fd":function(t,e,a){"use strict";var s={scrollPanel:{scrollingX:!1},bar:{hoverStyle:!0,onlyShowBarOnScroll:!1,background:"#ccc",scrollingX:!1,initialScrollX:!1,size:"5px"},rail:{}};e["a"]=s},c35b:function(t,e,a){},e8d0:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-box dis-flex-row"},[a("div",{staticClass:"main-box-left"},[a("el-tabs",{staticClass:"tabs-container",on:{"tab-click":t.changeLeftTabs},model:{value:t.activeLeft,callback:function(e){t.activeLeft=e},expression:"activeLeft"}},[a("el-tab-pane",{staticClass:"tabs-item",attrs:{label:"总部",name:"dept"}},[a("div",{staticClass:"page-list-left"},[t._l(t.roles.roleList,(function(e){return[a("div",{key:e.authorityId,staticClass:"list-item is-hover-current",class:{active:e.name===t.clickItem},on:{click:function(a){return t.changeRolesNode(e.name,e.authorityId)}}},[a("div",{staticClass:"list-item-left text-ellipsis click-this-area",class:{greytxt:1===e.status}},[t._v(t._s(e.name))]),a("el-button",{staticClass:"list-item-right is-visibility",staticStyle:{"margin-top":"3px"},attrs:{plain:"",size:"mini",type:"warning"},on:{click:function(a){return t.addOrUpdateHandle(e.name,e.authorityId)}}},[a("i",{staticClass:"el-icon-edit"}),t._v("编辑")])],1)]}))],2)]),a("el-tab-pane",{attrs:{label:"经销商",name:"distributor"}},[a("div",{staticClass:"page-list-left"},[t._l(t.roles.roleList,(function(e){return[a("div",{key:e.authorityId,staticClass:"list-item is-hover-current",class:{active:e.name===t.clickItem},on:{click:function(a){return t.changeRolesNode(e.name,e.authorityId)}}},[a("div",{staticClass:"list-item-left text-ellipsis click-this-area",class:{greytxt:1===e.status}},[t._v(t._s(e.name))]),a("el-button",{staticClass:"list-item-right is-visibility",staticStyle:{"margin-top":"3px"},attrs:{plain:"",size:"mini",type:"warning"},on:{click:function(a){return t.addOrUpdateHandle(e.name,e.authorityId)}}},[a("i",{staticClass:"el-icon-edit"}),t._v("编辑")])],1)]}))],2)])],1),a("el-button",{staticClass:"btn-add-public",attrs:{plain:"",size:"mini",type:"primary"},on:{click:function(e){return t.addOrUpdateHandle()}}},[a("i",{staticClass:"el-icon-plus"}),t._v("新增")]),a("el-switch",{staticClass:"switch-position",attrs:{"active-text":"有效","inactive-text":"全部"},on:{change:t.showAll},model:{value:t.isShow,callback:function(e){t.isShow=e},expression:"isShow"}})],1),a("span",{directives:[{name:"show",rawName:"v-show",value:!t.showRightBox,expression:"!showRightBox"}],staticClass:"unselect-role-or-posts"},[t._v("请先选择左边角色查看权限")]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showRightBox,expression:"showRightBox"}],staticClass:"main-box-right"},[a("div",{staticClass:"page-title"},[t._v(t._s(t.rightTopTip))]),a("div",{staticClass:"tree-container"},[a("el-tabs",{staticClass:"dis-flex-col",model:{value:t.activeRight,callback:function(e){t.activeRight=e},expression:"activeRight"}},[a("el-tab-pane",{attrs:{label:"按业务对象配置功能权限",disabled:"",name:"business"}},[a("div",{staticClass:"business"},[a("el-collapse",{attrs:{accordion:!0},model:{value:t.showBusiness,callback:function(e){t.showBusiness=e},expression:"showBusiness"}},[a("el-collapse-item",{attrs:{title:"按业务对象配置功能权限这一期暂时不做",name:"busi"}})],1)],1)]),a("el-tab-pane",{staticStyle:{height:"100%"},attrs:{label:"按菜单按钮配置功能权限",name:"menubtn"}},[a("vue-scroll",{staticClass:"menubtn",attrs:{ops:t.scrollops}},[t.roleAuthList.length?a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[a("el-tree",{attrs:{data:t.roleAuthList,"show-checkbox":"","node-key":"value","default-expand-all":"","default-expanded-keys":["1"],"default-checked-keys":t.authTreeDefaultChecked},on:{check:t.checkAuth}}),a("el-button",{staticClass:"save-btn",attrs:{type:"primary"},on:{click:t.handleRoleAuth}},[t._v("保存")])],1):t._e(),t.roleAuthList.length<=0?a("span",{staticClass:"no-data-tip"},[t._v("暂无可配置的权限")]):t._e()],1)],1)],1)],1)]),t.addOrUpdateVisible?a("add-or-update",{ref:"addOrUpdate",attrs:{allStatus:t.allStatus,editdept:t.addOredit,authorityId:t.authorityId},on:{whichPlatform:t.whichPlatform,refreshDataList:function(e){return t.getDataList()}}}):t._e()],1)},i=[],r=(a("8e6e"),a("ac6a"),a("cadf"),a("456d"),a("bd86")),l=a("3786"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"edit"==t.editdept?"编辑角色":"新增角色","close-on-click-modal":!1,visible:t.visible,width:"30%"},on:{"update:visible":function(e){t.visible=e}}},[a("el-form",{ref:"dataForm",attrs:{model:t.dataForm,rules:t.dataRule,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"角色分类：",prop:"platform"}},[a("el-select",{staticStyle:{width:"87%"},attrs:{filterable:"",disabled:"edit"===t.editdept,remote:"",clearable:"",placeholder:"请选择","reserve-keyword":""},on:{change:t.changeRole},model:{value:t.dataForm.platform,callback:function(e){t.$set(t.dataForm,"platform",e)},expression:"dataForm.platform"}},t._l(t.platformClass,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"角色名称：",prop:"name"}},[a("el-input",{staticStyle:{width:"87%"},attrs:{placeholder:"请输入",clearable:""},model:{value:t.dataForm.name,callback:function(e){t.$set(t.dataForm,"name",e)},expression:"dataForm.name"}})],1),a("el-form-item",{attrs:{label:"角色状态：",size:"mini",prop:"status"}},[a("el-radio-group",{model:{value:t.dataForm.status,callback:function(e){t.$set(t.dataForm,"status",e)},expression:"dataForm.status"}},[a("el-radio",{attrs:{label:"0"}},[t._v("有效")]),a("el-radio",{attrs:{label:"1"}},[t._v("无效")])],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.dataFormSubmit()}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.dataFormSubmit(e)}}},[t._v("确定")])],1)],1)},n=[],c=(a("6b54"),a("5d51")),d=a("2f62"),u=a("fa7d");function h(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function f(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?h(Object(a),!0).forEach((function(e){Object(r["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var p={props:["editdept","authorityId","allStatus"],data:function(){return{managerList:[],platformClass:[{id:1,name:"总部"},{id:2,name:"经销商"}],visible:!1,dataForm:{authorityId:"",platform:"",status:"0",name:""},dataRule:{platform:[{required:!0,message:"角色分类不能为空",trigger:"change"}],name:[{required:!0,message:"角色名称不能为空",trigger:"change"}],status:[{required:!0,message:"角色状态不能为空",trigger:"change"}]}}},methods:f({},Object(d["b"])({getAuthData:"getAuthData",getRoleList:"getRoleList"}),{changeRole:function(t){},init:function(t){var e=this;this.visible=!0,"edit"===this.editdept?Object(c["c"])({authorityId:this.authorityId}).then((function(a){if(200===a.code&&a.success){var s=a.data,i=Object(u["m"])(s,["authorityId","platform","status","name"]);i.status=i.status.toString(),e.dataForm=f({},i)}else t.$refs["dataForm"].resetFields()})):t.$refs["dataForm"].resetFields()},dataFormSubmit:function(){var t=this;this.$refs["dataForm"].validate((function(e){if(e){var a=Object(u["e"])(t.dataForm);if("edit"===t.editdept){var s=Object(u["e"])(t.dataForm);Object(c["b"])(s).then((function(){t.$message.success("编辑成功"),t.getRoleList({platform:s.platform,status:!0===t.allStatus?0:""}),t.visible=!1}))}else delete a.authorityId,Object(c["a"])(a).then((function(e){200===e.code&&e.success?(t.$message.success("新增成功"),t.getRoleList({platform:a.platform,status:!0===t.allStatus?0:""}),t.visible=!1):t.$message.error("新增失败")}))}})),this.$emit("whichPlatform",this.dataForm.platform)},hendleChangeCascader:function(){this.$refs["dataForm"]&&this.$refs["dataForm"].validateField("pid")}})},m=p,b=a("2877"),v=Object(b["a"])(m,o,n,!1,null,null,null),g=v.exports,y=a("47fd");function w(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function O(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?w(Object(a),!0).forEach((function(e){Object(r["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var k={components:{AddOrUpdate:g},data:function(){return{scrollops:y["a"],showRightBox:!1,authTreeDefaultChecked:[],tabsIndex:"0",whichPlat:"",authorityList:[],authorityId:"",auth_checked:"",clickItem:"",showEditBtn:!0,isShow:!0,allStatus:!0,addOredit:"",activeLeft:"dept",activeRight:"menubtn",showBusiness:"business",rightTopTip:"",showMenu:"menu",addOrUpdateVisible:!1,form:{type:[]}}},mounted:function(){this.getRoleList({platform:1,status:0})},computed:O({},Object(d["d"])({roles:"roles",auth:"auth"}),{roleAuthList:function(){return this.$store.state.auth.roleAuthList}}),watch:{roleAuthList:function(t){var e=[];this.recursionAuthTreeSelect(t,e),this.authTreeDefaultChecked=e}},methods:O({},Object(d["b"])({getAuthData:"getAuthData",getRoleList:"getRoleList",getRoleAuthList:"getRoleAuthList"}),{checkAuth:function(t,e){this.auth_checked=e.checkedKeys.join()},changeLeftTabs:function(t){this.tabsIndex=t.index;var e=t.index;this.isShow=!0,this.showRightBox=!1,this.getRoleList({platform:"0"===e?1:2,status:0})},handleCheckedCitiesChange:function(t){this.auth_checked=t.join()},changeRolesNode:function(t,e){this.showRightBox=!0,this.authorityId=e,this.clickItem=t,this.rightTopTip=t,this.getRoleAuthList({authorityId:e,platform:"0"===this.tabsIndex?1:2})},addOrUpdateHandle:function(t,e){var a=this;this.authorityId=e,this.addOredit=t?"edit":"add",this.addOrUpdateVisible=!0,this.$nextTick((function(){a.$refs.addOrUpdate.init(a.$refs.addOrUpdate,t)}))},handleRoleAuth:function(){var t=this,e={authorityId:this.authorityId,ids:this.auth_checked};this.auth_checked?Object(l["c"])(e).then((function(e){200===e.code&&e.success?t.$message.success("设置权限成功"):t.$message.error(e.message||"设置权限失败")})):this.$message.info("请先勾选角色")},recursionAuthTreeSelect:function(t,e){for(var a=0,s=t.length;a<s;a++)t[a].children&&t[a].children instanceof Array?this.recursionAuthTreeSelect(t[a].children,e):t[a].own&&e.push(t[a].value)},showAll:function(t){this.allStatus=t;var e=t;this.getRoleList({platform:"0"===this.tabsIndex?1:2,status:e?0:""})},whichPlatform:function(t){this.whichPlat=t,this.activeLeft=1==t?"dept":"distributor"}})},x=k,j=(a("fb1b"),Object(b["a"])(x,s,i,!1,null,"73be7f8c",null));e["default"]=j.exports},fb1b:function(t,e,a){"use strict";var s=a("c35b"),i=a.n(s);i.a}}]);