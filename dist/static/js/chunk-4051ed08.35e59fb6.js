(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4051ed08"],{2406:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-box dis-flex-row"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"wrapper"},[a("h2",[t._v("板件报价明细表")]),a("el-row",{staticStyle:{padding:"10px 0","border-bottom":"1px solid #ccc"},attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("span",{staticClass:"padding-label title"},[t._v("订单号:")]),t._v(t._s(t.orderDetailData.orderCode))]),a("el-col",{attrs:{span:6}},[a("span",{staticClass:"padding-label title"},[t._v("部门名称:")]),t._v(t._s(t.orderDetailData.storeName))]),a("el-col",{attrs:{span:6}},[a("span",{staticClass:"padding-label title"},[t._v("提交初审时间:")]),t._v(t._s(t.DWY_UTILS.getTimeYMD(t.firstAuditSubmitTime)))])],1),t.productionList.length?a("div",{staticClass:"table-box"},[a("el-tabs",{staticClass:"tab-content",attrs:{type:"border-card"},on:{"tab-click":t.handleTabClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.productionList,(function(e,r){return a("el-tab-pane",{key:r,attrs:{name:"tab"+r}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-date"}),t._v(" "+t._s(e.auditName)+" ")]),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("span",{staticClass:"padding-label"},[t._v("生产单号:")]),t._v(" "+t._s(e.productionOrderCode))])],1),a("el-row",{staticStyle:{padding:"15px 0"},attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("span",{staticClass:"padding-label"},[t._v("总金额(零售价):")]),t._v(" ￥ "+t._s(t.renderMoney(e.retailPrice))+" 元")]),a("el-col",{attrs:{span:6}},[a("span",{staticClass:"padding-label"},[t._v("理论结算价:")]),t._v(" ￥ "+t._s(t.renderMoney(e.nominalSettlementPrice))+" 元")]),a("el-col",{attrs:{span:6}},[a("span",{staticClass:"padding-label"},[t._v("结算系数(折扣):")]),t._v(" "+t._s(t.renderMoney(e.discount)))]),a("el-col",{attrs:{span:6}},[a("span",{staticClass:"padding-label"},[t._v("实际结算价:")]),t._v(" ￥ "+t._s(t.renderMoney(e.finalSettlementPrice))+" 元")])],1),a("el-table",{attrs:{data:t.tableData,"row-key":"id","span-method":t.objectSpanMethod,"tree-props":{children:"orderOfferList",hasChildren:!0},border:"","default-expand-all":""}},t._l(t.columnData,(function(e,r){return a("el-table-column",{key:r,attrs:{width:e.width,label:e.label},scopedSlots:t._u([{key:"default",fn:function(r){return[e.operation?t._e():a("span",[t._v("\n                                    "+t._s(r.row[e.prop])+"\n                                ")])]}}],null,!0)})})),1)],1)})),1)],1):a("p",{staticClass:"p-nodata"},[t._v("暂无数据")])],1)])},i=[],n=(a("8e6e"),a("cadf"),a("456d"),a("96cf"),a("3b8d")),o=(a("ac6a"),a("bd86")),l=a("f8b7"),s=a("2f62");function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function d(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(Object(a),!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var p={data:function(){return{activeName:"tab0",loading:!1,orderId:this.$route.params.orderId,firstAuditSubmitTime:"",tableData:[],productionList:[],columnData:[{label:"",width:"50"},{prop:"modelName",label:"名称"},{prop:"textureName",label:"材质"},{prop:"width",label:"宽",width:"60px"},{prop:"deep",label:"深",width:"60px"},{prop:"height",label:"高",width:"60px"},{prop:"quotationUnit",label:"单位",width:"70px"},{prop:"quantity",label:"数量",width:"70px"},{prop:"unitCost",label:"成本单价"},{prop:"unitPrice",label:"销售单价"},{prop:"additionalPrice",label:"附加费"},{prop:"nonStandardCoef",label:"价格系数"},{prop:"retailPrice",label:"金额"},{prop:"costPrice",label:"理论结算价"},{prop:"discount",label:"结算折扣"},{prop:"finalSettlementPrice",label:"实际结算价"},{prop:"modelType",label:"型号"},{prop:"productCode",label:"产品编号"},{prop:"color",label:"颜色"},{prop:"standards",label:"规格"}]}},mounted:function(){this.getDataList()},computed:d({},Object(s["d"])({orderDetailData:function(t){return t.order.orderDetailData}})),methods:{getPriceDetail:function(t){var e=this;Object(l["F"])({productionOrderId:t}).then((function(t){e.tableData.length=0,t.data&&t.data.forEach((function(t,a){var r;r="成品"===t.productType?e.productTotal(t):e.recursionData(t.orderOfferList),t.orderOfferList.push({id:t.id+a,subtotal:!0,modelName:"小计: 理论结算价: ".concat(r.costPrice," 元 实际结算价: ").concat(r.finalSettlementPrice," 元 金额小计: ").concat(r.retailPrice," 元")}),e.tableData.push(t),e.loading=!1}))}))},getDataList:function(){var t=this,e=this.orderId;this.productionList.length=0,Object(l["E"])({orderId:e}).then(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(a){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.firstAuditSubmitTime=a.data.firstAuditSubmitTime,r=a.data.productionList,r&&r.length){e.next=4;break}return e.abrupt("return");case 4:return t.loading=!0,t.productionList=r,e.next=8,t.getPriceDetail(r[t.activeName.slice(-1)]["productionOrderId"]);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},recursionData:function(t){var e=this,a=0,r=0,i=0;if(t||t.length)return t.forEach((function(t,n){a=Math.round(100*a+100*t.retailPrice)/100,r=Math.round(100*r+100*t.costPrice)/100,i=Math.round(100*i+100*t.finalSettlementPrice)/100,t.orderOfferList.length&&(a+=parseFloat(e.recursionData(t.orderOfferList).retailPrice),r+=parseFloat(e.recursionData(t.orderOfferList).costPrice),i+=parseFloat(e.recursionData(t.orderOfferList).finalSettlementPrice))})),{retailPrice:a.toFixed(2),costPrice:r.toFixed(2),finalSettlementPrice:i.toFixed(2)}},objectSpanMethod:function(t){var e=t.row,a=(t.column,t.rowIndex,t.columnIndex);if(e.subtotal&&1===a)return{rowspan:1,colspan:this.columnData.length}},handleTabClick:function(t,e){this.getPriceDetail(this.productionList[t.index]["productionOrderId"])},productTotal:function(t){return{retailPrice:t.retailPrice,costPrice:t.costPrice,finalSettlementPrice:t.finalSettlementPrice}}}},u=p,b=(a("fa3d"),a("2877")),f=Object(b["a"])(u,r,i,!1,null,"4c9e111a",null);e["default"]=f.exports},bad8:function(t,e,a){},fa3d:function(t,e,a){"use strict";var r=a("bad8"),i=a.n(r);i.a}}]);