(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-94cd8daa"],{"094b":function(t,e,r){},2758:function(t,e,r){},"2c79":function(t,e,r){"use strict";var i=r("094b"),a=r.n(i);a.a},"47fd":function(t,e,r){"use strict";var i={scrollPanel:{scrollingX:!1},bar:{hoverStyle:!0,onlyShowBarOnScroll:!1,background:"#ccc",scrollingX:!1,initialScrollX:!1,size:"5px"},rail:{}};e["a"]=i},67621:function(t,e,r){},"8f20":function(t,e,r){t.exports=r.p+"static/img/404.a5d86fc2.png"},"93b3":function(t,e,r){"use strict";r.r(e);var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"main-box dis-flex-col"},[r("vue-scroll",{attrs:{ops:t.scrollops}},[r("el-tabs",{model:{value:t.stepsActive,callback:function(e){t.stepsActive=e},expression:"stepsActive"}},[r("el-tab-pane",{attrs:{label:"关联方案提审",name:"second"}},[r("merge-scheme")],1),r("el-tab-pane",{attrs:{label:"生产单",name:"third"}},[r("production-order",{ref:"productionOrder"})],1)],1)],1)],1)},a=[],o=(r("8e6e"),r("ac6a"),r("cadf"),r("456d"),r("bd86")),n=r("47fd"),s=r("2f62"),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"program-show"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isShowAddOrderBtn,expression:"!isShowAddOrderBtn"}],staticClass:"content"},[i("div",{staticClass:"left"},[i("div",{staticClass:"info-item"},[i("span",{staticClass:"info-label"},[t._v("方案名称：")]),i("span",[t._v(t._s(t.programDetailObj.name))])]),i("div",{staticClass:"info-item"},[i("span",{staticClass:"info-label"},[t._v("户型：")]),i("span",[t._v(t._s(t.programDetailObj.specName))])]),i("div",{staticClass:"info-item"},[i("span",{staticClass:"info-label"},[t._v("面积：")]),i("span",[t._v(t._s(t.programDetailObj.realArea&&t.programDetailObj.realArea.toFixed(2))),i("span",{directives:[{name:"show",rawName:"v-show",value:t.programDetailObj.realArea,expression:"programDetailObj.realArea"}]},[t._v("㎡")])])])]),i("div",{staticClass:"right"},[i("div",{staticClass:"info-item"},[i("span",{staticClass:"info-label"},[t._v("渲染图：")]),i("viewer",{staticClass:"img-outer-big-box"},[i("img",{attrs:{src:t.programDetailObj.coverPic,alt:"暂无渲染图"}})])],1)])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowAddOrderBtn,expression:"isShowAddOrderBtn"}],staticClass:"no-program",on:{click:function(e){return t.createOrder("add")}}},[i("img",{attrs:{src:r("8f20"),alt:""}})]),i("div",{staticClass:"bottom"},[i("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.isShowAddOrderBtn,expression:"!isShowAddOrderBtn"}],attrs:{type:"primary",icon:"el-icon-scissors"},on:{click:function(e){return t.handleCreateOrder("add")}}},[t._v("方案设计")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isShowAddOrderBtn,expression:"isShowAddOrderBtn"}],attrs:{type:"primary",plain:"",icon:"el-icon-plus"},on:{click:function(e){return t.createOrder("add")}}},[t._v("新增方案")]),i("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-refresh"},on:{click:function(e){return t.arraignmentProgram()}}},[t._v("更换关联方案")])],1),i("el-dialog",{attrs:{title:"关联方案",visible:t.bindProgramVisible,"append-to-body":!0,"modal-append-to-body":!1,width:"50%"},on:{"update:visible":function(e){t.bindProgramVisible=e}}},[i("el-row",[i("el-col",{attrs:{span:24}},[i("el-table",{attrs:{data:t.programList,border:"",height:"373"}},[i("el-table-column",{attrs:{type:"index",label:"序号",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.$index+1+t.orderPagaination.size*(t.orderPagaination.current-1)))])]}}])}),i("el-table-column",{attrs:{prop:"name",label:"名称"}}),i("el-table-column",{attrs:{prop:"specName",label:"户型",width:"150"}}),i("el-table-column",{attrs:{prop:"modifiedTime",label:"更新日期",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(t.moment(e.row.modifiedTime).format("YYYY-MM-DD")))])]}}])}),i("el-table-column",{attrs:{prop:"x",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[i("el-button",{directives:[{name:"show",rawName:"v-show",value:0===e.row.bindStatus,expression:"scope.row.bindStatus === 0"}],attrs:{type:"text",size:"small",icon:"el-icon-link"},on:{click:function(r){return t.bindProgram(e.row)}}},[t._v("关联")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:2===e.row.bindStatus,expression:"scope.row.bindStatus === 2"}],attrs:{type:"text",size:"small",icon:"el-icon-link"},on:{click:function(r){return t.unBindDesignProgram(e.row)}}},[t._v("取消关联")]),i("span",{directives:[{name:"show",rawName:"v-show",value:2===e.row.bindStatus,expression:"scope.row.bindStatus === 2"}],staticStyle:{"margin-left":"7px"}},[t._v("已关联")]),i("span",{directives:[{name:"show",rawName:"v-show",value:1===e.row.bindStatus,expression:"scope.row.bindStatus === 1"}]},[t._v("其他订单关联")])],1)]}}])})],1),i("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>=20,expression:"total >= 20"}],staticStyle:{"margin-top":"10px"},attrs:{"current-page":t.orderPagaination.current,"page-sizes":[10,20,50],"page-size":t.orderPagaination.size,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeOrderChange,"current-change":t.handleCurrentOrderChange}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.bindProgramVisible=!1}}},[t._v("关闭")])],1)],1)],1)},d=[],c=(r("f751"),r("f8b7"));function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function p(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach((function(e){Object(o["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var b={name:"mergeScheme",data:function(){return{programDetailObj:{name:"",realArea:"",specName:"",coverPic:""},orderPagaination:{current:1,size:20},orderId:this.$route.params.orderId,total:0,programList:[],bindProgramVisible:!1,isShowAddOrderBtn:!1}},computed:p({},Object(s["d"])({orderDetailData:function(t){return t.order.orderDetailData}})),watch:{"orderDetailData.designId":{handler:function(t,e){this.init()}}},mounted:function(){this.init()},methods:p({},Object(s["b"])({getDetailData:"getOrderDetailData"}),{init:function(){this.orderDetailData.designId?(this.isShowAddOrderBtn=!1,this.getProgramDetail(this.orderDetailData.designId)):this.isShowAddOrderBtn=!0},getProgramDetail:function(t){var e=this;Object(c["X"])({designId:t}).then((function(t){e.programDetailObj=p({},t.data)}))},createOrder:function(){var t=4;Object(c["n"])({dest:t}).then((function(t){window.open(t.data)}))},handleCreateOrder:function(){if(this.orderDetailData.designId){var t=1;Object(c["n"])({dest:t,designid:this.orderDetailData.designId}).then((function(t){window.open(t.data)}))}else this.$message.warning("操作失败")},getProgramList:function(){var t=this,e=Object.assign({orderId:this.orderId},this.orderPagaination);Object(c["o"])(e).then((function(e){t.total=e.data.total,t.programList=e.data.records}))},arraignmentProgram:function(){this.bindProgramVisible=!0,this.getProgramList()},bindProgram:function(t){var e=this,r=t.designId;this.bindDesignId=t.designId;var i=this.orderId;r&&"NODID"!==r&&Object(c["W"])({designId:r,orderId:i}).then((function(t){e.$message.success("方案关联成功"),e.getDetailData({orderId:i}),e.getProgramList(),e.getProgramDetail(r),e.DesignId=r,e.hasDesignId=!0,e.isShowAddOrderBtn=!1}))},unBindDesignProgram:function(t){var e=this,r=t.designId,i=this.orderId;Object(c["ib"])({designId:r,orderId:i}).then((function(t){e.$message.success("方案取消成功"),e.getDetailData({orderId:i}),e.getProgramList(),e.isShowAddOrderBtn=!0}))},handleSizeOrderChange:function(t){this.orderPagaination.size=t,this.getProgramList()},handleCurrentOrderChange:function(t){this.orderPagaination.current=t,this.getProgramList()}})},m=b,h=(r("2c79"),r("2877")),f=Object(h["a"])(m,l,d,!1,null,"76a9ba7b",null),g=f.exports,O=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"main-box dis-flex-row"},[r("div",{staticClass:"wrapper"},[r("production-order-table"),r("finish-order-table"),r("el-dialog",{attrs:{title:"提交初审",visible:t.submitVisible,"append-to-body":!0,"modal-append-to-body":!1,width:"50%"},on:{"update:visible":function(e){t.submitVisible=e},open:t.opendialog}},[r("div",{staticClass:"date"},[r("span",{staticStyle:{"margin-right":"5px"}},[r("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("期望交付(发货)日期")]),r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd","picker-options":t.pickerEnd,type:"date",placeholder:"选择日期"},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),t.programList.length?r("el-divider",{attrs:{"content-position":"left"}},[t._v("定制生产单"),r("i",{staticClass:"el-icon-thumb thumb"})]):t._e(),t.programList.length?r("el-row",[r("el-col",{attrs:{span:24}},[r("el-table",{ref:"table1",attrs:{data:t.programList,border:"",height:"240px"}},[r("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),r("el-table-column",{attrs:{type:"selection",label:"",width:"50",selectable:function(){return!1}}}),r("el-table-column",{attrs:{prop:"kjlAuditName",label:"审核名称",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",[t._v(t._s(e.row.kjlAuditName?e.row.kjlAuditName:"未命名"))])]}}],null,!1,3257067513)}),r("el-table-column",{attrs:{prop:"productionOrderCode",label:"生产单编号"}}),r("el-table-column",{attrs:{prop:"kjlAuditCode",label:"审核编号"}}),r("el-table-column",{attrs:{prop:"kjlStatusName",label:"审核进度",width:"100"}}),r("el-table-column",{attrs:{prop:"statusName",label:"状态",width:"100"}}),r("el-table-column",{attrs:{prop:"comment",label:"记录信息"}})],1)],1)],1):t._e(),t.finishProductList.length?r("el-divider",{attrs:{"content-position":"left"}},[t._v("成品生产单"),r("i",{staticClass:"el-icon-thumb thumb"})]):t._e(),t.finishProductList.length?r("el-row",[r("el-col",{attrs:{span:24}},[r("el-table",{ref:"table2",attrs:{data:t.finishProductList,border:"",height:"240px"}},[r("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),r("el-table-column",{attrs:{type:"selection",label:"",width:"50",selectable:function(){return!1}}}),r("el-table-column",{attrs:{prop:"kjlAuditName",label:"审核名称",width:"100"}}),r("el-table-column",{attrs:{prop:"productionOrderCode",label:"生产单编号",width:"130"}}),r("el-table-column",{attrs:{prop:"productTypeName",label:"类型",width:"100"}}),r("el-table-column",{attrs:{prop:"statusName",label:"状态"}})],1)],1)],1):t._e(),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmitAudit}},[t._v("确定")])],1)],1),r("submit-supply-dialog",{ref:"submitVisibleDom"}),t.orderDetailData.status<2001&&(t.programList.length||t.finishProductList.length)?r("el-button",{staticClass:"submit-btn",attrs:{type:"primary",size:"small",icon:"el-icon-s-promotion",title:t.disabledSubmitBtn?"暂无可提交的订单":"",disabled:t.disabledSubmitBtn},on:{click:t.onlyDataFormSubmit}},[t._v("提交初审")]):t._e()],1)])},w=[],v=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-divider",{attrs:{"content-position":"left"}},[t._v("定制生产单"),r("i",{staticClass:"el-icon-thumb thumb"})]),r("el-button",{staticStyle:{"margin-bottom":"3px"},attrs:{type:"primary",icon:"el-icon-refresh-right",size:"mini",plain:""},on:{click:t.refreshProgramData}},[t._v("更新数据")]),r("el-table",{attrs:{data:t.programList,border:""}},[r("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),r("el-table-column",{attrs:{prop:"kjlAuditName",label:"审核名称",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",[t._v(t._s(e.row.kjlAuditName?e.row.kjlAuditName:"未命名"))])]}}])}),r("el-table-column",{attrs:{prop:"productionOrderCode",label:"生产单编号",width:"160"}}),r("el-table-column",{attrs:{prop:"kjlAuditCode",label:"审核编号",width:"130"}}),r("el-table-column",{attrs:{prop:"kjlStatusName",label:"审核进度",width:"100"}}),r("el-table-column",{attrs:{prop:"statusName",label:"状态",width:"100"}}),r("el-table-column",{attrs:{prop:"operateComment",label:"记录信息",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-popover",{staticStyle:{cursor:"pointer"},attrs:{placement:"top-start",title:e.row.operateComment,width:"150",trigger:"hover"}},[r("span",{staticClass:"text-ellipsis-2",attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(e.row.operateComment))])])]}}])}),r("el-table-column",{attrs:{prop:"comment",label:"提审备注",width:"200"}}),r("el-table-column",{attrs:{prop:"retailPrice",label:"销售金额",width:"100"}}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.cancelFlag&&t.hasPermission(t.Permission.order.audit_cancel.code)?r("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-error"},on:{click:function(r){return t.deleteThisAudit(e.row)}}},[t._v("作废")]):t._e()]}}])})],1)],1)},j=[];function y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function D(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?y(Object(r),!0).forEach((function(e){Object(o["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var P={computed:D({},Object(s["d"])({programList:function(t){return t.order.programKjlList}})),watch:{$route:function(t,e){this.getProgramKjlListData({orderId:this.$route.params.orderId})}},mounted:function(){this.getProgramKjlListData()},methods:D({},Object(s["b"])({getProgramKjlListData:"getProgramKjlList"}),{deleteThisAudit:function(t){var e=this,r=t.productionOrderId;this.$confirm("此操作将作废该定制生产单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(c["k"])({productionOrderId:r}).then((function(t){200===t.code&&t.success&&(e.$message.success("操作成功"),e.getProgramKjlListData())}))})).catch((function(){}))},refreshProgramData:function(){this.getProgramKjlListData({orderId:this.$route.params.orderId})}})},k=P,I=(r("ed74"),Object(h["a"])(k,v,j,!1,null,"b0ecbd4a",null)),L=I.exports,_=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-divider",{attrs:{"content-position":"left"}},[t._v("成品生产单"),r("i",{staticClass:"el-icon-thumb thumb"})]),t.hasPermission(t.Permission.product.finished_add.code)?r("el-button",{staticClass:"add-pro-btn",attrs:{type:"primary",size:"mini",plain:""},on:{click:t.addFinishProduct}},[r("i",{staticClass:"el-icon-plus"}),t._v(" 新增成品")]):t._e(),r("el-table",{attrs:{data:t.finishProductList,border:""}},[r("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),r("el-table-column",{attrs:{prop:"kjlAuditName",label:"审核名称",width:"130"}}),r("el-table-column",{attrs:{prop:"productionOrderCode",label:"生产单编号",width:"160"}}),r("el-table-column",{attrs:{prop:"productTypeName",label:"类型",width:"130"}}),r("el-table-column",{attrs:{prop:"kjlStatusName",label:"审核进度",width:"100"}}),r("el-table-column",{attrs:{prop:"statusName",label:"状态",width:"100"}}),r("el-table-column",{attrs:{prop:"retailPrice",label:"销售金额",width:"100"}}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.orderDetailData.status<2001&&t.hasPermission(t.Permission.product.finished_edit.code)?r("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(r){return t.editThisPro(e.row)}}},[t._v("编辑")]):t._e(),t.orderDetailData.status<2001&&t.hasPermission(t.Permission.product.finished_detele.code)?r("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-error"},on:{click:function(r){return t.deleteThisPro(e.row)}}},[t._v("作废")]):t._e()]}}])})],1)],1)},S=[];function x(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function C(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?x(Object(r),!0).forEach((function(e){Object(o["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var A={computed:C({},Object(s["d"])({orderDetailData:function(t){return t.order.orderDetailData},finishProductList:function(t){return t.order.finishKjlList}})),watch:{$route:function(t,e){this.getFinishListData({orderId:this.$route.params.orderId})}},mounted:function(){this.getFinishListData()},methods:C({},Object(s["b"])({getFinishListData:"getFinishKjlList"}),{editThisPro:function(t){this.$router.push({path:"/order/editfinish/".concat(this.orderDetailData.orderId,"/").concat(this.orderDetailData.orderCode,"/").concat(t.productionOrderId,"/").concat(this.orderDetailData.orderType)})},addFinishProduct:function(){this.$router.push({path:"/order/addfinish/".concat(this.orderDetailData.orderId,"/").concat(this.orderDetailData.orderCode,"/").concat(this.orderDetailData.orderType)})},deleteThisPro:function(t){var e=this,r=t.productionOrderId;this.$confirm("此操作将作废该成品生产单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(c["l"])({productionOrderId:r}).then((function(t){200===t.code&&t.success&&(e.$message.success("操作成功"),e.getFinishListData())}))})).catch((function(){}))}})},T=A,$=(r("bf50"),Object(h["a"])(T,_,S,!1,null,"10707480",null)),N=$.exports,E=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-dialog",{attrs:{title:"提交补单初审",visible:t.submitVisible,"destroy-on-close":!0,top:"80px","modal-append-to-body":!1,width:"75%"},on:{"update:visible":function(e){t.submitVisible=e},open:t.openDialog}},[r("div",{staticClass:"date"},[r("span",{staticStyle:{"margin-right":"5px"}},[r("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("期望交付(发货)日期：")]),r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd","picker-options":t.pickerEnd,type:"date",placeholder:"选择日期"},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),t.programTablemodel.programList.length?r("el-divider",{attrs:{"content-position":"left"}},[t._v("定制生产单"),r("i",{staticClass:"el-icon-thumb thumb"})]):t._e(),t.programTablemodel.programList.length?r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form",{ref:"form1",attrs:{rules:t.programTablemodel.rules,model:t.programTablemodel}},[r("el-table",{ref:"table",attrs:{border:"",data:t.programTablemodel.programList}},[r("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),r("el-table-column",{attrs:{prop:"kjlAuditName",label:"审核名称",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",[t._v(t._s(e.row.kjlAuditName?e.row.kjlAuditName:"未命名"))])]}}],null,!1,3257067513)}),r("el-table-column",{attrs:{prop:"productionOrderCode",label:"生产单编号",width:"160"}}),r("el-table-column",{attrs:{prop:"kjlAuditCode",label:"审核编号",width:"150"}}),r("el-table-column",{attrs:{prop:"kjlStatusName",label:"审核进度",width:"80"}}),r("el-table-column",{attrs:{prop:"retailPrice",label:"销售金额",width:"100"}}),r("el-table-column",{attrs:{label:"关联原生产单","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-form-item",{attrs:{prop:"programList."+e.$index+".originalProductionOrderId",rules:t.programTablemodel.rules.originalProductionOrderId}},[r("el-select",{attrs:{placeholder:"请输入选择",clearable:"",disabled:t.rowDisabled(e.row),filterable:""},on:{focus:function(r){return t.getOriginOrderList(e.$index,r)}},model:{value:e.row.originalProductionOrderId,callback:function(r){t.$set(e.row,"originalProductionOrderId",r)},expression:"scope.row.originalProductionOrderId"}},t._l(t.originOrderSelectList,(function(t){return r("el-option",{key:t.productionOrderId,attrs:{label:t.kjlAuditName,value:t.productionOrderId}})})),1)],1)]}}],null,!1,1837232391)}),r("el-table-column",{attrs:{label:"补单原因","min-width":"175"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-form-item",{attrs:{prop:"programList."+e.$index+".reasonIds",rules:t.programTablemodel.rules.reasonIds}},[r("el-select",{attrs:{placeholder:"请输入选择",clearable:"",filterable:"",disabled:t.rowDisabled(e.row),multiple:""},model:{value:e.row.reasonIdList,callback:function(r){t.$set(e.row,"reasonIdList",r)},expression:"scope.row.reasonIdList"}},t._l(t.reasonList,(function(t){return r("el-option",{key:t.id,attrs:{label:t.dictName,value:t.dictCode}})})),1)],1)]}}],null,!1,856576912)})],1)],1)],1)],1):t._e(),t.finishTablemodel.finishProductList.length?r("el-divider",{attrs:{"content-position":"left"}},[t._v("成品生产单"),r("i",{staticClass:"el-icon-thumb thumb"})]):t._e(),t.finishTablemodel.finishProductList.length?r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form",{ref:"form2",attrs:{rules:t.finishTablemodel.rules,model:t.finishTablemodel}},[r("el-table",{ref:"table2",attrs:{border:"",data:t.finishTablemodel.finishProductList}},[r("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),r("el-table-column",{attrs:{prop:"kjlAuditName",label:"审核名称",width:"100"}}),r("el-table-column",{attrs:{prop:"productionOrderCode",label:"生产单编号",width:"160"}}),r("el-table-column",{attrs:{prop:"kjlStatusName",label:"审核进度",width:"90"}}),r("el-table-column",{attrs:{prop:"statusName",label:"状态",width:"80"}}),r("el-table-column",{attrs:{prop:"retailPrice",label:"销售金额",width:"100"}}),r("el-table-column",{attrs:{label:"关联原生产单","min-width":"175"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-form-item",{attrs:{prop:"finishProductList."+e.$index+".originalProductionOrderId",rules:t.finishTablemodel.rules.originalProductionOrderId}},[r("el-select",{attrs:{placeholder:"请输入选择",clearable:"",filterable:"",disabled:t.rowDisabled(e.row)},on:{focus:function(r){return t.getOriginOrderList(e.$index,r)}},model:{value:e.row.originalProductionOrderId,callback:function(r){t.$set(e.row,"originalProductionOrderId",r)},expression:"scope.row.originalProductionOrderId"}},t._l(t.originOrderSelectList,(function(t){return r("el-option",{key:t.productionOrderId,attrs:{label:t.kjlAuditName,value:t.productionOrderId}})})),1)],1)]}}],null,!1,2137275500)}),r("el-table-column",{attrs:{label:"补单原因","min-width":"175"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-form-item",{attrs:{prop:"finishProductList."+e.$index+".reasonIds",rules:t.finishTablemodel.rules.reasonIds}},[r("el-select",{attrs:{disabled:t.rowDisabled(e.row),placeholder:"请输入选择",clearable:"",filterable:"",multiple:""},model:{value:e.row.reasonIdList,callback:function(r){t.$set(e.row,"reasonIdList",r)},expression:"scope.row.reasonIdList"}},t._l(t.reasonList,(function(t){return r("el-option",{key:t.id,attrs:{label:t.dictName,value:t.dictCode}})})),1)],1)]}}],null,!1,1137585499)})],1)],1)],1)],1):t._e(),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmitAudit("form1","form2")}}},[t._v("确定")])],1)],1)},B=[],z=r("b562");function K(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function V(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?K(Object(r),!0).forEach((function(e){Object(o["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var F={data:function(){return{pickerEnd:{disabledDate:function(t){return t.getTime()<Date.now()-864e5}},orderId:this.$route.params.orderId,submitVisible:!1,date:"",originOrderSelectList:[],reasonList:[],page:{size:1e3,current:1,orderId:""},programTablemodel:{rules:{originalProductionOrderId:{required:!0,message:"必填字段",trigger:"change"},reasonIdList:{required:!0,message:"必填字段",trigger:"blur"}},programList:[]},finishTablemodel:{rules:{originalProductionOrderId:{required:!0,message:"必填字段",trigger:"change"},reasonIdList:{required:!0,message:"必填字段",trigger:"blur"}},finishProductList:[]},bindDesignId:""}},computed:V({},Object(s["d"])({orderDetailData:function(t){return t.order.orderDetailData},programList:function(t){return t.order.programKjlList},finishList:function(t){return t.order.finishKjlList}})),mounted:function(){this.date=this.orderDetailData.expectedDeliveryTime},methods:V({},Object(s["c"])({closeCurrentPage:"CLOSE_CURRENT_PAGE"}),{},Object(s["b"])({getDetailData:"getDetailData"}),{getOriginOrderList:function(t,e){var r=this,i=this.orderDetailData.originalOrderId;Object(c["B"])({orderId:i}).then((function(t){200===t.code&&t.success&&(r.originOrderSelectList=t.data)}))},rowDisabled:function(t){return 1003===t.kjlStatus||1004===t.kjlStatus||1005===t.kjlStatus},getReasons:function(){var t=this;Object(z["c"])({dictTypeCode:"order_resupply_reason"}).then((function(e){200===e.code&&e.success&&(t.reasonList=e.data)}))},handleSubmitAudit:function(t,e){var r=this;if(this.date){var i=this.programTablemodel.programList.concat(this.finishTablemodel.finishProductList),a=[],o=this.orderId;i.map((function(t){t.auditName||(t.auditName="未命名"),a.push({kjlAuditId:t.kjlAuditId,kjlLevelId:t.kjlLevelId,kjlAuditName:t.kjlAuditName,kjlAuditCode:t.kjlAuditCode,kjlStatus:t.kjlStatus,productType:t.productType,productionOrderId:t.productionOrderId,originalProductionOrderId:t.originalProductionOrderId,reasonIds:t.reasonIdList&&t.reasonIdList.join(),comment:t.comment})}));var n={orderId:o,expectedDeliveryTime:this.date,auditDesigns:JSON.stringify(a)},s=!0;this.programTablemodel.programList.length&&this.$refs[t].validate((function(t){t||(s=!1)})),this.finishTablemodel.finishProductList.length&&this.$refs[e].validate((function(t){t||(s=!1)})),s&&Object(c["T"])(n).then((function(t){200===t.code&&t.success&&(r.$message.success("提交成功"),r.submitVisible=!1,r.closeCurrentPage(r.$route.fullPath),r.$router.push("/order/detail/".concat(r.orderId)))}))}else this.$message.warning("请输入期望交付日期")},openDialog:function(){this.programTablemodel.programList=this.programList,this.finishTablemodel.finishProductList=this.finishList,this.getReasons()}})},M=F,R=(r("e143"),Object(h["a"])(M,E,B,!1,null,"7bb370b0",null)),q=R.exports;function J(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function X(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?J(Object(r),!0).forEach((function(e){Object(o["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var Y={components:{productionOrderTable:L,finishOrderTable:N,submitSupplyDialog:q},data:function(){return{disabledSubmitBtn:!1,submitVisible:!1,date:"",orderId:this.$route.params.orderId,pickerEnd:{disabledDate:function(t){return t.getTime()<Date.now()-864e5}}}},computed:X({},Object(s["d"])({finishProductList:function(t){return t.order.finishKjlList},programList:function(t){return t.order.programKjlList},orderDetailData:function(t){return t.order.orderDetailData}})),methods:X({},Object(s["b"])({getDetailData:"getOrderDetailData",getProgramKjlListData:"getProgramKjlList",getFinishListData:"getFinishKjlList"}),{opendialog:function(){this.checkedAllProgramList()},checkedAllProgramList:function(){var t=this;this.programList.map((function(e){t.$nextTick((function(){this.$refs&&this.$refs.table1.toggleRowSelection(e,!0)}))})),this.finishProductList.map((function(e){t.$nextTick((function(){this.$refs&&this.$refs.table2.toggleRowSelection(e,!0)}))}))},onlyDataFormSubmit:function(){10===this.orderDetailData.orderType?this.submitVisible=!0:20===this.orderDetailData.orderType&&(this.$refs.submitVisibleDom.submitVisible=!0)},handleSubmitAudit:function(){var t=this,e=this.programList.concat(this.finishProductList),r=[];e.map((function(t){t.auditName||(t.auditName="未命名"),r.push({kjlAuditId:t.kjlAuditId,kjlLevelId:t.kjlLevelId,kjlAuditName:t.kjlAuditName,kjlAuditCode:t.kjlAuditCode,kjlStatus:t.kjlStatus,productType:t.productType,productionOrderId:t.productionOrderId,comment:t.comment})}));var i={orderId:this.orderId,designId:this.orderDetailData.designId,expectedDeliveryTime:this.date,auditDesigns:JSON.stringify(r)};e.length?this.date?Object(c["T"])(i).then((function(e){200===e.code&&e.success&&(t.submitVisible=!1,t.$message.success("提交成功"),t.getProgramKjlListData(),t.getFinishKjlList(),t.$router.push("/order/detail/".concat(t.orderId)))})):this.$message.warning("请选择期望(发货)日期"):this.$message.warning("暂无可提交的生产定制单")}})},G=Y,U=(r("a647"),Object(h["a"])(G,O,w,!1,null,"95ce6002",null)),W=U.exports;function H(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function Q(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?H(Object(r),!0).forEach((function(e){Object(o["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var Z={name:"editOrder",components:{mergeScheme:g,productionOrder:W},data:function(){return{scrollops:n["a"],orderStatus:"",stepsActive:"second"}},computed:Q({},Object(s["d"])({orderDetailData:function(t){return t.order.orderDetailData}})),watch:{$route:function(t,e){this.init()}},mounted:function(){this.init()},methods:Q({},Object(s["b"])({getDetailData:"getOrderDetailData"}),{init:function(){var t=this;this.getDetailData({orderId:this.$route.params.orderId}).then((function(){t.$route.params.type?t.stepsActive="third":t.stepsActive="second"}))}})},tt=Z,et=(r("c918"),Object(h["a"])(tt,i,a,!1,null,"f1d4de62",null));e["default"]=et.exports},a647:function(t,e,r){"use strict";var i=r("2758"),a=r.n(i);a.a},a77b:function(t,e,r){},b562:function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"d",(function(){return o})),r.d(e,"b",(function(){return n})),r.d(e,"c",(function(){return s}));var i=r("b775");function a(t){return Object(i["a"])({url:"/areaCode/list",method:"get",params:t})}function o(t){return Object(i["a"])({url:"/upload/uploadFile",method:"post",data:t})}function n(t){return Object(i["a"])({url:"/upload/deleteFile",method:"delete",params:t})}function s(t){return Object(i["a"])({url:"/dict/list",method:"get",params:t})}},bf50:function(t,e,r){"use strict";var i=r("d0ec"),a=r.n(i);a.a},c918:function(t,e,r){"use strict";var i=r("ec83"),a=r.n(i);a.a},d0ec:function(t,e,r){},e143:function(t,e,r){"use strict";var i=r("67621"),a=r.n(i);a.a},ec83:function(t,e,r){},ed74:function(t,e,r){"use strict";var i=r("a77b"),a=r.n(i);a.a}}]);